{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>AdminLTE 3 | Dashboard 3</title>

  <!-- Google Font: Source Sans Pro -->
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Source+Sans+Pro:300,400,400i,700&display=fallback">
  <!-- Font Awesome Icons -->
  <link rel="stylesheet" href="{% static 'Adminlte/plugins/fontawesome-free/css/all.min.css' %}">
  <!-- IonIcons -->
  <link rel="stylesheet" href="https://code.ionicframework.com/ionicons/2.0.1/css/ionicons.min.css' }">
  <!-- Theme style -->
  <link rel="stylesheet" href="{% static 'Adminlte/dist/css/adminlte.min.css' %}">
  <!-- CSS only -->
<!--  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-Zenh87qX5JnK2Jl0vWa8Ck2rdkQ2Bzep5IDxbcnCeuOxjzrPF/et3URy9Bv1WTRi" crossorigin="anonymous">-->
</head>
<!--
`body` tag options:

  Apply one or more of the following classes to to the body tag
  to get the desired effect

  * sidebar-collapse
  * sidebar-mini
-->
<body class="hold-transition sidebar-mini layout-fixed">
<div class="wrapper">
  <!-- Navbar -->
  <nav class="main-header navbar navbar-expand navbar-white navbar-light">
    <!-- Left navbar links -->
    <ul class="navbar-nav">
      <li class="nav-item">
        <a href="index3.html" class="brand-link text-center" style="width: 150px">
          <img src="{% static 'Adminlte/dist/img/AdminLTELogo.png' %}" alt="AdminLTE Logo" class="brand-image img-circle elevation-3" style="opacity: .8">
          <span class="brand-text font-weight-light">Trinity</span>
        </a>
      </li>
<!--      <li class="nav-item">-->
<!--        <a class="nav-link" data-widget="pushmenu" href="#" role="button"><i class="fas fa-bars"></i></a>-->
<!--      </li>-->
<!--      <li class="nav-item d-none d-sm-inline-block">-->
<!--        <a href="index3.html" class="nav-link">Trinity</a>-->
<!--      </li>-->
<!--      <li class="nav-item d-none d-sm-inline-block">-->
<!--        <a href="#" class="nav-link">Contact</a>-->
<!--      </li>-->
    </ul>

    <!-- Right navbar links -->
    <ul class="navbar-nav ml-auto">

      <!-- Notifications Dropdown Menu -->
      <li class="nav-item dropdown">
        <a class="nav-link" data-toggle="dropdown" href="#">
          <i class="far fa-bell"></i>
          <span class="badge badge-warning navbar-badge">15</span>
        </a>
        <div class="dropdown-menu dropdown-menu-lg dropdown-menu-right">
          <span class="dropdown-item dropdown-header">15 Notifications</span>
          <div class="dropdown-divider"></div>
          <a href="#" class="dropdown-item">
            <i class="fas fa-envelope mr-2"></i> 4 new messages
            <span class="float-right text-muted text-sm">3 mins</span>
          </a>
          <div class="dropdown-divider"></div>
          <a href="#" class="dropdown-item">
            <i class="fas fa-users mr-2"></i> 8 friend requests
            <span class="float-right text-muted text-sm">12 hours</span>
          </a>
          <div class="dropdown-divider"></div>
          <a href="#" class="dropdown-item">
            <i class="fas fa-file mr-2"></i> 3 new reports
            <span class="float-right text-muted text-sm">2 days</span>
          </a>
          <div class="dropdown-divider"></div>
          <a href="#" class="dropdown-item dropdown-footer">See All Notifications</a>
        </div>
      </li>
      <li class="nav-item">
        <a class="nav-link" data-widget="fullscreen" href="#" role="button">
          <i class="fas fa-expand-arrows-alt"></i>
        </a>
      </li>
<!--      <li class="nav-item">-->
<!--        <a class="nav-link" data-widget="control-sidebar" data-slide="true" href="#" role="button">-->
<!--          <i class="fas fa-th-large"></i>-->
<!--        </a>-->
<!--      </li>-->
    </ul>
  </nav>
  <!-- /.navbar -->
<!--    <nav class="navbar navbar-expand-lg navbar-light sticky-top bg-white p-2 shadow" style="&#45;&#45;bs-bg-opacity: 0.75" data-darkreader-inline-bgcolor="">-->
<!--        <div class="container">-->
<!--            <a class="navbar-brand" href="#">Web developers</a>-->
<!--            <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarColor03" aria-controls="navbarColor03" aria-expanded="false" aria-label="Toggle navigation">-->
<!--                <span class="navbar-toggler-icon"></span>-->
<!--            </button>-->

<!--            <div class="collapse navbar-collapse" id="navbarColor03">-->
<!--                <ul class="navbar-nav mx-auto">-->
<!--                <li class="nav-item active">-->
<!--                    <a class="nav-link" href="#">Home <span class="sr-only">(current)</span></a>-->
<!--                </li>-->
<!--                <li class="nav-item">-->
<!--                    <a class="nav-link" href="#">Features</a>-->
<!--                </li>-->
<!--                <li class="nav-item">-->
<!--                    <a class="nav-link" href="#">Pricing</a>-->
<!--                </li>-->
<!--                <li class="nav-item">-->
<!--                    <a class="nav-link" href="#">About</a>-->
<!--                </li>-->
<!--                </ul>-->
<!--                <div class="form-inline justify-content-end" style="width: 154px;">-->
<!--                <button class="btn btn-primary">Get started!</button>-->
<!--                </div>-->
<!--            </div>-->
<!--        </div>-->
<!--    </nav>-->

  {% include 'account/sidebar.html' %}

  <!-- Content Wrapper. Contains page content -->
  <div class="content-wrapper">
    <!-- Content Header (Page header) -->
    <section class="content-header">
      <div class="container-fluid">
        <div class="row mb-2">
          <div class="col-sm-6">
            <h1>Invoice</h1>
          </div>
          <div class="col-sm-6">
            <ol class="breadcrumb float-sm-right">
              <li class="breadcrumb-item"><a href="#">Home</a></li>
              <li class="breadcrumb-item active">Invoice</li>
            </ol>
          </div>
        </div>
      </div><!-- /.container-fluid -->
    </section>

    <section class="content">
      <div class="container-fluid">
        <div class="row">
          <div class="col-12">
<!--            <div class="callout callout-info">-->
<!--              <h5><i class="fas fa-info"></i> Note:</h5>-->
<!--              This page has been enhanced for printing. Click the print button at the bottom of the invoice to test.-->
<!--            </div>-->


            <!-- Main content -->
            <div class="invoice p-3 mb-3">
              <!-- title row -->
              <div class="row">
                <div class="col-12">
                  <h4>
                    <i class="fas fa-globe"></i> Trinity, Inc.
                    <small class="float-right">{{ now.date }}</small>
                  </h4>
                </div>
                <!-- /.col -->
              </div>
              <!-- info row -->
              <div class="row invoice-info">
                <div class="col-sm-4 invoice-col">
                  From
                  <address>
                    <strong>Trinity, Inc.</strong><br>
                    Phone: (804) 123-5432<br>
                    Email: info@almasaeedstudio.com
                  </address>
                </div>
                <!-- /.col -->
                <div class="col-sm-4 invoice-col">
                  To
                  <address>
                    <strong>{{ request.user }}</strong><br>
                    Phone: (555) 539-1037<br>
                    Email: john.doe@example.com
                  </address>
                </div>
                <!-- /.col -->
                <div class="col-sm-4 invoice-col">
                  <b>Invoice #007612</b><br>
                  <br>
                  <b>Order ID:</b> 4F3S8J<br>
                  <b>Payment Due:</b> 2/22/2014<br>
                  <b>Account:</b> 968-34567
                </div>
                <!-- /.col -->
              </div>
              <!-- /.row -->

              <!-- Table row -->
              <div class="row">
                <div class="col-12 table-responsive">
                  <table class="table table-striped">
                    <thead>
                    <tr>
                      <th>Qty</th>
                      <th>Product</th>
                      <th>Serial #</th>
                      <th>Description</th>
                      <th>Subtotal</th>
                    </tr>
                    </thead>
                    <tbody>
                    <tr>
                      <td>1</td>
                      <td>{{ product.name }}</td>
                      <td>455-981-221</td>
                      <td>{{ product.description }}</td>
                      <td>${{ product.price }}</td>
                    </tr>
<!--                    <tr>-->
<!--                      <td>1</td>-->
<!--                      <td>Need for Speed IV</td>-->
<!--                      <td>247-925-726</td>-->
<!--                      <td>Wes Anderson umami biodiesel</td>-->
<!--                      <td>$50.00</td>-->
<!--                    </tr>-->
<!--                    <tr>-->
<!--                      <td>1</td>-->
<!--                      <td>Monsters DVD</td>-->
<!--                      <td>735-845-642</td>-->
<!--                      <td>Terry Richardson helvetica tousled street art master</td>-->
<!--                      <td>$10.70</td>-->
<!--                    </tr>-->
<!--                    <tr>-->
<!--                      <td>1</td>-->
<!--                      <td>Grown Ups Blue Ray</td>-->
<!--                      <td>422-568-642</td>-->
<!--                      <td>Tousled lomo letterpress</td>-->
<!--                      <td>$25.99</td>-->
<!--                    </tr>-->
                    </tbody>
                  </table>
                </div>
                <!-- /.col -->
              </div>
              <!-- /.row -->

              <div class="row">
                <!-- accepted payments column -->
                <div class="col-6">
                  <span>Payment Method</span>
                    <div class="card">

                      <div class="accordion" id="accordionExample">

                        <div class="card">
                          <div class="card-header p-0" id="headingTwo">
                            <h2 class="mb-0">
                              <button class="btn btn-light btn-block text-left collapsed p-3 rounded-0 border-bottom-custom" type="button" data-toggle="collapse" data-target="#collapseTwo" aria-expanded="false" aria-controls="collapseTwo">
                                <div class="d-flex align-items-center justify-content-between">

                                  <span>Paypal</span>
                                  <img src="https://i.imgur.com/7kQEsHU.png" width="30">

                                </div>
                              </button>
                            </h2>
                          </div>
                          <div id="collapseTwo" class="collapse" aria-labelledby="headingTwo" data-parent="#accordionExample">
                            <div class="card-body">
                              <div class="row justify-content-center">
                                <div class="col-10">
<!--                              <input type="text" class="form-control" placeholder="Paypal email">-->
                                  <div id="paypal-button-container"></div>

                                    <!-- Include the PayPal JavaScript SDK -->
                                    <script src="https://www.paypal.com/sdk/js?client-id=AdePkehLvtEJmnWwfdvLxutETAi48kbmbQtFW1fTi58MDvdM4EaqxywXH1bcqQhbNEKheYoc4BPOU9SK&currency=USD&disable-funding=sepa"></script>
                                    <script src="//cdn.jsdelivr.net/npm/js-cookie@3.0.1/dist/js.cookie.min.js"></script>

                                    <script>
                                        const csrftoken = Cookies.get('csrftoken');
                                        // Render the PayPal button into #paypal-button-container
                                        var total = '{{ product.price }}'
                                        paypal.Buttons({

                                            // Set up the transaction
                                            createOrder: function(data, actions) {
                                                return actions.order.create({
                                                    purchase_units: [{
                                                        amount: {
                                                            value: parseFloat(total).toFixed(2)
                                                        }
                                                    }]
                                                });
                                            },

                                            // Finalize the transaction
                                            onApprove: function(data, actions) {
                                                return actions.order.capture().then(function(orderData) {
                                                    // Successful capture! For demo purposes:
                                                    console.log('Capture result', orderData, JSON.stringify(orderData, null, 2));
                                                    var transaction = orderData.purchase_units[0].payments.captures[0];
                                                    alert('Transaction '+ transaction.status + ': ' + transaction.id + '\n\nSee console for all available details');

                                                    submitFormData()

                                                    // Replace the above to show a success message within this page, e.g.
                                                    // const element = document.getElementById('paypal-button-container');
                                                    // element.innerHTML = '';
                                                    // element.innerHTML = '<h3>Thank you for your payment!</h3>';
                                                    // Or go to another URL:  actions.redirect('thank_you.html');
                                                });
                                            }


                                        }).render('#paypal-button-container');
                                    </script>
                                </div>
                              </div>

                            </div>
                          </div>
                        </div>

                        <div class="card">
                          <div class="card-header p-0">
                            <h2 class="mb-0">
                              <button class="btn btn-light btn-block text-left p-3 rounded-0" data-toggle="collapse" data-target="#collapseOne" aria-expanded="true" aria-controls="collapseOne">
                                <div class="d-flex align-items-center justify-content-between">

                                  <span>Credit card</span>
                                  <div class="icons">
                                    <img src="https://i.imgur.com/2ISgYja.png" width="30">
                                    <img src="https://i.imgur.com/W1vtnOV.png" width="30">
                                    <img src="https://i.imgur.com/35tC99g.png" width="30">
                                    <img src="https://i.imgur.com/2ISgYja.png" width="30">
                                  </div>

                                </div>
                              </button>
                            </h2>
                          </div>

                          <div id="collapseOne" class="collapse" aria-labelledby="headingOne" data-parent="#accordionExample">
                            <div class="card-body payment-card-body">
                              <div class="row justify-content-center">
                                <div class="col-10">
<!--                                  <button type="button" class="btn btn-primary btn-lg btn-block">Pay Now with Stripe!</button>-->
                                  <form action="{% url 'payment:process' %}" method="post">
                                      {% csrf_token %}
<!--                                      <input type="submit" value="Pay Now!">-->
                                      <button type="submit" class="btn btn-primary btn-lg btn-block">Pay Now with Stripe!</button>
                                  </form>
                                </div>
                              </div>



<!--                              <span class="font-weight-normal card-text">Card Number</span>-->
<!--                              <div class="input">-->

<!--                                <i class="fa fa-credit-card"></i>-->
<!--                                <input type="text" class="form-control" placeholder="0000 0000 0000 0000">-->

<!--                              </div>-->

<!--                              <div class="row mt-3 mb-3">-->

<!--                                <div class="col-md-6">-->

<!--                                  <span class="font-weight-normal card-text">Expiry Date</span>-->
<!--                                  <div class="input">-->

<!--                                    <i class="fa fa-calendar"></i>-->
<!--                                    <input type="text" class="form-control" placeholder="MM/YY">-->

<!--                                  </div>-->

<!--                                </div>-->


<!--                                <div class="col-md-6">-->

<!--                                  <span class="font-weight-normal card-text">CVC/CVV</span>-->
<!--                                  <div class="input">-->

<!--                                    <i class="fa fa-lock"></i>-->
<!--                                    <input type="text" class="form-control" placeholder="000">-->

<!--                                  </div>-->

<!--                                </div>-->


<!--                              </div>-->

<!--                              <span class="text-muted certificate-text"><i class="fa fa-lock"></i> Your transaction is secured with ssl certificate</span>-->

                            </div>
                          </div>
                        </div>

                      </div>

                    </div>





<!--                  <p class="lead">Payment Methods:</p>-->
<!--                  <img src="{% static 'Adminlte/dist/img/credit/visa.png' %}" alt="Visa" style="width: 15%">-->
<!--                  <img src="{% static 'Adminlte/dist/img/credit/mastercard.png' %}" alt="Mastercard" style="width: 15%">-->
<!--                  <img src="{% static 'Adminlte/dist/img/credit/american-express.png' %}" alt="American Express" style="width: 15%">-->
<!--                  <img src="{% static 'Adminlte/dist/img/credit/paypal2.png' %}" alt="Paypal" style="width: 15%">-->

<!--                  &lt;!&ndash; Set up a container element for the button &ndash;&gt;-->
<!--                  <div id="paypal-button-container"></div>-->

<!--                  &lt;!&ndash; Include the PayPal JavaScript SDK &ndash;&gt;-->
<!--                  <script src="https://www.paypal.com/sdk/js?client-id=AdePkehLvtEJmnWwfdvLxutETAi48kbmbQtFW1fTi58MDvdM4EaqxywXH1bcqQhbNEKheYoc4BPOU9SK&currency=USD&disable-funding=sepa"></script>-->
<!--                  <script src="//cdn.jsdelivr.net/npm/js-cookie@3.0.1/dist/js.cookie.min.js"></script>-->

<!--                  <script>-->
<!--                      const csrftoken = Cookies.get('csrftoken');-->
<!--                      // Render the PayPal button into #paypal-button-container-->
<!--                      var total = '{{ product.price }}'-->
<!--                      paypal.Buttons({-->

<!--                          // Set up the transaction-->
<!--                          createOrder: function(data, actions) {-->
<!--                              return actions.order.create({-->
<!--                                  purchase_units: [{-->
<!--                                      amount: {-->
<!--                                          value: parseFloat(total).toFixed(2)-->
<!--                                      }-->
<!--                                  }]-->
<!--                              });-->
<!--                          },-->

<!--                          // Finalize the transaction-->
<!--                          onApprove: function(data, actions) {-->
<!--                              return actions.order.capture().then(function(orderData) {-->
<!--                                  // Successful capture! For demo purposes:-->
<!--                                  console.log('Capture result', orderData, JSON.stringify(orderData, null, 2));-->
<!--                                  var transaction = orderData.purchase_units[0].payments.captures[0];-->
<!--                                  alert('Transaction '+ transaction.status + ': ' + transaction.id + '\n\nSee console for all available details');-->

<!--                                  submitFormData()-->

<!--                                  // Replace the above to show a success message within this page, e.g.-->
<!--                                  // const element = document.getElementById('paypal-button-container');-->
<!--                                  // element.innerHTML = '';-->
<!--                                  // element.innerHTML = '<h3>Thank you for your payment!</h3>';-->
<!--                                  // Or go to another URL:  actions.redirect('thank_you.html');-->
<!--                              });-->
<!--                          }-->


<!--                      }).render('#paypal-button-container');-->
<!--                  </script>-->
                  <script type="text/javascript">

                    function submitFormData(){
                      console.log('Payment button clicked')

                      var userFormData = {
                                        'order_id':'{{ order.id }}',
                                        'product_id':'{{ product.id }}',
                                        // 'user_id':'{{ user.id }}',
                                        'total':total,
                                    }
                      console.log('User Info:', userFormData)
                      var url = "{% url 'payment:paypal-webhook' %}"
                      fetch(url, {
                        method:'POST',
                        headers:{
                            'Content-Type':'applicaiton/json',
                            'X-CSRFToken':csrftoken,
                        },
                        body:JSON.stringify({'form':userFormData}),
	    	          })
                      .then((response) => response.json())
                      .then((data) => {
                        console.log('Success:', data);
                        alert('Transaction completed');

                        window.location.href = "{% url 'payment:completed' %}"
                      })

                    }
                  </script>







<!--                  <p class="text-muted well well-sm shadow-none" style="margin-top: 10px;">-->
<!--                    Etsy doostang zoodles disqus groupon greplin oooj voxy zoodles, weebly ning heekya handango imeem-->
<!--                    plugg-->
<!--                    dopplr jibjab, movity jajah plickers sifteo edmodo ifttt zimbra.-->
<!--                  </p>-->
                </div>
                <!-- /.col -->
                <div class="col-6">
                  <p class="lead">Amount Due 2/22/2014</p>

                  <div class="table-responsive">
                    <table class="table">
                      <tr>
                        <th style="width:50%">Subtotal:</th>
                        <td>$250.30</td>
                      </tr>
                      <tr>
                        <th>Tax (9.3%)</th>
                        <td>$10.34</td>
                      </tr>
                      <tr>
                        <th>Shipping:</th>
                        <td>$5.80</td>
                      </tr>
                      <tr>
                        <th>Total:</th>
                        <td>$265.24</td>
                      </tr>
                    </table>
                  </div>
                </div>
                <!-- /.col -->
              </div>
              <!-- /.row -->

              <!-- this row will not appear when printing -->
<!--              <div class="row no-print">-->
<!--                <div class="col-12">-->
<!--                  <a href="invoice-print.html" rel="noopener" target="_blank" class="btn btn-default"><i class="fas fa-print"></i> Print</a>-->
<!--                  <button type="button" class="btn btn-success float-right"><i class="far fa-credit-card"></i> Submit-->
<!--                    Payment-->
<!--                  </button>-->
<!--                  <button type="button" class="btn btn-primary float-right" style="margin-right: 5px;">-->
<!--                    <i class="fas fa-download"></i> Generate PDF-->
<!--                  </button>-->
<!--                </div>-->
<!--              </div>-->
            </div>
            <!-- /.invoice -->
          </div><!-- /.col -->
        </div><!-- /.row -->
      </div><!-- /.container-fluid -->
    </section>
    <!-- /.content -->
  </div>
  <!-- /.content-wrapper -->

  <!-- Control Sidebar -->
  <aside class="control-sidebar control-sidebar-dark">
    <!-- Control sidebar content goes here -->
  </aside>
  <!-- /.control-sidebar -->

  <!-- Main Footer -->
  <footer class="main-footer">
    <strong>Copyright &copy; 2014-2021 <a href="https://adminlte.io">AdminLTE.io</a>.</strong>
    All rights reserved.
    <div class="float-right d-none d-sm-inline-block">
      <b>Version</b> 3.2.0
    </div>
  </footer>
</div>
<!-- ./wrapper -->

<!-- REQUIRED SCRIPTS -->

<!-- jQuery -->
<script src="{% static 'Adminlte/plugins/jquery/jquery.min.js' %}"></script>
<!-- Bootstrap -->
<script src="{% static 'Adminlte/plugins/bootstrap/js/bootstrap.bundle.min.js' %}"></script>
<!-- JavaScript Bundle with Popper -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-OERcA2EqjJCMA+/3y+gxIOqMEjwtxJY7qPCqsdltbNJuaOe923+mo//f6V8Qbsw3" crossorigin="anonymous"></script>
<!-- AdminLTE -->
<script src="{% static 'Adminlte/dist/js/adminlte.js' %}"></script>

<!-- OPTIONAL SCRIPTS -->
<script src="{% static 'Adminlte/plugins/chart.js/Chart.min.js' %}"></script>
<!-- AdminLTE for demo purposes -->
<!--<script src="{% static 'Adminlte/dist/js/demo.js' %}"></script>-->
<!-- AdminLTE dashboard demo (This is only for demo purposes) -->
<script src="{% static 'Adminlte/dist/js/pages/dashboard3.js' %}"></script>
</body>
</html>
